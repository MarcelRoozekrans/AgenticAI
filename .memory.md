# Agent Memory

> This file preserves knowledge across AI sessions. Update it as the project evolves.
> Referenced automatically by the development-cycle.prompt.md workflow.

## Project Context

### What This Project Does
AgenticAI - A framework for building reliable AI workflows with agentic primitives and context engineering.

### Key Architectural Decisions

| Date | Decision | Rationale | Impact |
|------|----------|-----------|--------|
| 2026-01-22 | Adopt 3-layer framework (Markdown + Primitives + Context) | Enables reliable, repeatable AI workflows | Guides all agent development |
| | Session splitting by phase | Fresh context = better focus and fewer mistakes | Architect/Developer/Reviewer in separate sessions |
| | Memory-driven development | Preserve patterns and lessons across sessions | .memory.md, .instructions.md, .chatmode.md |

### Important Patterns

#### Pattern 1: Clean Architecture Layers
```
Domain (entities, use cases, interfaces)
  â†“ depends on â†“
Application (orchestration, services)
  â†“ depends on â†“
Infrastructure (repositories, external services)
  â†“ depends on â†“
Presentation (controllers, validators)

Rule: Never depend upward!
```

#### Pattern 2: TDD Red-Green-Refactor
```
1. WRITE FAILING TEST (Red)
   - Run test, confirm failure
   
2. IMPLEMENT MINIMALLY (Green)
   - Write just enough code to pass
   - Run test, confirm pass
   
3. REFACTOR (Blue)
   - Clean up code
   - Apply SOLID principles
   - Run test, still passing
```

#### Pattern 3: Agentic Primitive Files
- `.instructions.md` - Reusable guidance with `applyTo` patterns
- `.chatmode.md` - Role-based expertise with MCP tool boundaries
- `.prompt.md` - Orchestrated workflows with validation gates
- `.spec.md` - Implementation blueprints with acceptance criteria
- `.memory.md` - This file! Patterns and lessons

## Known Issues & Quirks

### Issue 1: [Title]
- **Description**: What the issue is
- **Workaround**: How to handle it
- **Status**: Open / Being addressed / Won't fix

## Successful Implementations

### Implementation 1: Development Cycle Workflow
- **Approach**: 5-phase orchestrated development with session splitting
- **Files**: `.github/prompts/development-cycle.prompt.md`
- **Lessons**:
  - Session splitting dramatically improves focus
  - Validation gates prevent mistakes early
  - Spec-driven development enables deterministic handoff
  - Memory integration improves consistency

## Failed Approaches (Don't Repeat)

### Approach 1: Single Session for All Phases
- **Problem**: Agent loses context between phases, repeats work, forgets constraints
- **Alternative**: Use separate sessions with session splitting - @architect â†’ @developer â†’ @reviewer
- **Lesson**: Fresh context windows are worth the context reload cost

## Critical Success Factors

### ðŸš¨ Tests Must Catch Real Failures
- Test passing â‰  Software working
- Tests must verify BEHAVIOR, not just existence
- If software is broken, tests must FAIL
- Example: Don't test `expect(obj).toBeDefined()` test `expect(obj.property).toBe(expectedValue)`

### ðŸš¨ Software Must Actually Run
- Phase 5 is MANDATORY
- Start the software in actual runtime environment
- Test the feature manually (user perspective)
- Check console/logs (must be CLEAN)
- If Phase 5 fails â†’ Return to Phase 2 (tests were insufficient)

### ðŸš¨ Good Tests Are Hard To Write
- Shallow tests pass but don't catch bugs
- Good tests:
  - Verify specific behavior (not just existence)
  - Cover error cases (what if invalid input?)
  - Cover edge cases (what if empty/null/extreme values?)
  - Would FAIL if implementation is wrong

## Known Issues & Quirks

### Issue: Test Suite Passes but Software Broken
- **Category**: Testing Quality
- **Description**: All unit tests pass but feature doesn't work when running software
- **Root Cause**: Tests only verify code paths exist, not that behavior is correct
- **How to Prevent**: 
  1. Write behavior-based tests, not existence tests
  2. Manually test in running software (Phase 5)
  3. If Phase 5 fails, improve tests in Phase 2
  4. Update `.memory.md` with missing test cases
- **Status**: Open - being addressed by adding Phase 5 runtime verification
When you need reliable implementation:
1. Create `.spec.md` with acceptance criteria
2. Hand off spec to @developer chatmode in new session
3. Developer implements from spec, not memory
4. Spec becomes source of truth for review

### Pattern: Memory-Driven Test Generation
When writing tests:
1. Check `.memory.md#failed-approaches` - test cases you failed on before
2. Check `.memory.md#known-issues` - edge cases to handle
3. Add new edge cases you discover to the file
4. Next feature benefits from accumulated knowledge

### Pattern: Architecture Consistency
When designing new features:
1. Review `.memory.md#key-architectural-decisions`
2. Check existing patterns in `src/` structure
3. Follow same domain modeling approach
4. Document in `.memory.md#important-patterns` if different

## External Dependencies & Context

### MCP (Model Context Protocol)
- GitHub-mcp-server: Access to repositories, PRs, issues
- Used by: development-cycle.prompt.md workflow
- Status: Available for secure tool access

### Agentic Framework References
- [GitHub Blog: Agentic Primitives](https://github.blog/ai-and-ml/github-copilot/how-to-build-reliable-ai-workflows-with-agentic-primitives-and-context-engineering/)
- [Awesome AI Native](https://danielmeppiel.github.io/awesome-ai-native/)
- [Spec Kit Tool](https://github.com/github/spec-kit)

## Session Memory (Current)

This section is updated during active development:

### Current Feature Being Built
- Feature: [Name]
- Phase: [Architecture/Implementation/Review]
- Spec Location: `docs/[feature].spec.md`
- Key Decision: [What approach are we taking]
- Next Steps: [What comes next]
- Blockers: [Any issues preventing progress]

---

## How to Update This File

### During Architecture Phase
- Add to "Key Architectural Decisions" table
- Update "Current Feature Being Built"

### During Implementation
- Document patterns discovered in "Important Patterns"
- Log issues in "Known Issues & Quirks"
- Update "Session Memory" with progress

### During Review
- If critical pattern found, add to "Important Patterns"
- If issue found, add to "Known Issues"
- If approach failed, add to "Failed Approaches"

### After Completion
- Move "Current Feature Being Built" to "Successful Implementations"
- Archive completed features
- Update "Community Patterns" with generalizable insights

- **Version**: x.x.x
- **Quirks**: Any gotchas to remember
- **Docs**: Link to documentation

## Team Conventions

### Preferences
- Preferred libraries for common tasks
- Code style preferences beyond linter rules
- Review process notes

## Session Log

<!-- Track significant changes across sessions -->

### Session: YYYY-MM-DD
- What was worked on
- Key outcomes
- Open items for next session
